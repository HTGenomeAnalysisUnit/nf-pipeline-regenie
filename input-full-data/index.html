
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Edoardi Giacopuzzi">
      
      
      
        <link rel="prev" href="../input-phenotype-file/">
      
      
        <link rel="next" href="../input-indep-snps/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Full genetic dataset - nf-regenie-gwas</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#full-genotype-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="nf-regenie-gwas" class="md-header__button md-logo" aria-label="nf-regenie-gwas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            nf-regenie-gwas
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Full genetic dataset
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/HTGenomeAnalysisUnit/nf-pipeline-regenie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../quick-start/" class="md-tabs__link">
        
  
    
  
  Quick start

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../running-modes/" class="md-tabs__link">
          
  
  Running mode

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../input-phenotype-file/" class="md-tabs__link">
          
  
  Input files

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../main-parameters/" class="md-tabs__link">
          
  
  Configuration

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../outputs/" class="md-tabs__link">
        
  
    
  
  Output files

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../additional-notes/" class="md-tabs__link">
        
  
    
  
  Additional notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="nf-regenie-gwas" class="md-nav__button md-logo" aria-label="nf-regenie-gwas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    nf-regenie-gwas
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HTGenomeAnalysisUnit/nf-pipeline-regenie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Running mode
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Running mode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    single model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multi projects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multi models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Input files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Input files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-phenotype-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phenotype / Covariate file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Full genetic dataset
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Full genetic dataset
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Input formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vcf-format" class="md-nav__link">
    <span class="md-ellipsis">
      vcf format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgen-format" class="md-nav__link">
    <span class="md-ellipsis">
      bgen format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgen-format" class="md-nav__link">
    <span class="md-ellipsis">
      pgen format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed-format" class="md-nav__link">
    <span class="md-ellipsis">
      bed format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-dataset-split-by-chromosome" class="md-nav__link">
    <span class="md-ellipsis">
      Input dataset split by chromosome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Performance tips
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-indep-snps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Independent QCed SNPs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-ld-panel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LD panel (optional)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-rare-variants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inputs for rare variants tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-models-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models table (multi models run)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-projects-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project table (multi projects run)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-conditional-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conditional / interaction analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-reuse-step1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Re-use step1 predictions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../main-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tower-monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tower monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hpc-profile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    define HPC profile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parallelization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optimize parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../top-hits-annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    top hits annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full-params-list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    full list of params
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../outputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output files
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Additional notes
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Input formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vcf-format" class="md-nav__link">
    <span class="md-ellipsis">
      vcf format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgen-format" class="md-nav__link">
    <span class="md-ellipsis">
      bgen format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgen-format" class="md-nav__link">
    <span class="md-ellipsis">
      pgen format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed-format" class="md-nav__link">
    <span class="md-ellipsis">
      bed format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-dataset-split-by-chromosome" class="md-nav__link">
    <span class="md-ellipsis">
      Input dataset split by chromosome
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Performance tips
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="full-genotype-data">Full genotype data</h1>
<p>To perform genetic association or rare variants analysis (regenie step 2) you must provide the full genetic dataset for your study, usually a large genetic dataset from imputation or sequencing. No QC is performed on teh full genetic dataset so ensure it is clean.</p>
<p>Input dataset for GWAS analysis is defined by <code>genotypes_imputed</code> and <code>genotypes_imputed_format</code> parameters, while input dataset for rare variants analysis is defined by <code>genotypes_rarevar</code> and <code>genotypes_rarevar_format</code>. The format parameter accepts 4 possible formats: vcf, bgen, pgen or bed.</p>
<p>The input dataset can be provided as a single file, split in multiple chunk files, or split by chromosome including a <code>{CHROM}</code> tag in the input filename (see below).</p>
<h2 id="input-formats">Input formats</h2>
<h3 id="vcf-format">vcf format</h3>
<ul>
<li>input format: <code>'vcf'</code></li>
<li>input dataset: <code>'path/to/my_data.vcf.gz'</code></li>
</ul>
<p>The input VCF must be in .vcf.gz format and will be converted to <code>bgen</code> format using plink2 and <code>--const-fid 0</code> option. The following parameters are used to control the conversion (see <a href="https://www.cog-genomics.org/plink/2.0/input#vcf">relevant plink2 documentation</a>):</p>
<ul>
<li><code>vcf_min_gq</code>: minimum genotype quality (GQ) for a genotype to be included in the PGEN output.</li>
<li><code>gwas_read_dosage_from</code> / <code>rarevar_read_dosage_from</code>: these params can be set to decide from which field to read GT probabilities when converting VCF for the GWAS and rare variants input datasets, respectively. Accepted options are <code>'HDS'</code> (default) which usually works for VCF from Minimac4 imputation, <code>'DS'</code> for Minimac3 dosages or <code>'GP'</code> for genotype probabilities (to use with VCF from sequencing). Default is <code>null</code>, actual genotypes will be imported.</li>
<li><code>import_dosage_certainty</code>: when <code>read_dosage_from = 'GP'</code> this parameter controls the minimum probability accepted to set a genotype. You can set to null to remove this filter. Suggetion is to use <code>0.7</code>.</li>
<li><code>vcf_fixed_fid</code>: when <code>null</code> the conversion is performed using <code>--double-id</code> option, so that sample IDs in the VCF are used also for FID. If you set a string (like <code>'0'</code>) than the FID column in the VCF is fixed and set to this value for all samples. Default is <code>0</code>.</li>
</ul>
<p>The converted dataset is saved to output folder when <code>save_pgen = true</code> (default).</p>
<p><strong>NB1.</strong> Using the default setting the resulting pgen dataset will have constant FID set to '0' and IID corresponding to the sample IDs in the VCF. You need to be sure that this nomenclature is consistent with the covariates and phenotype input files.</p>
<p><strong>NB2.</strong> There are some aspects to keep in mind about the conversion from VCF to pgen format (see <a href="https://www.cog-genomics.org/plink/2.0/input#vcf">plink2 docs</a> for more details):</p>
<ul>
<li>PGEN can store genotype dosage, but not genotype probabilities, thus probabilities are collapsed to dosages during conversion, which is usually fine for most analyses.</li>
<li>When using <code>DS</code> or <code>HDS</code> during import, the dosage are read directly from the VCF.</li>
<li>When using <code>GP</code>, the genotype probabilites are converted to dosages according to the <code>import_dosage_certainty</code> parameter. The default value of <code>0.7</code> means that a genotype dosage are set only if the probability of the most likely genotype is &gt;= 0.7, otherwise teh whole genotype is set to missing.</li>
</ul>
<h3 id="bgen-format">bgen format</h3>
<ul>
<li>input format: <code>'bgen'</code></li>
<li>input dataset: <code>'path/to/my_data.bgen'</code></li>
</ul>
<p>Some additional files are expected when using bgen format:</p>
<ol>
<li>A bgi index for you bgen file. For a dataset named <code>my_dataset.bgen</code> the expected name of index is <code>my_dataset.bgen.bgi</code>. You can generate this using <a href="https://enkre.net/cgi-bin/code/bgen/dir?ci=trunk">bgenix tool</a>. You can use something like <code>bgenix -g my_data.bgen -index</code>.</li>
<li>A sample file. For a dataset named <code>my_dataset.bgen</code> the expected name of index is <code>my_dataset.sample</code>. This is standard sample file defined for the bgen format which contains sample level information.</li>
</ol>
<p><strong>NB:</strong> When using BGEN input, make sure that the sample ID in the BGEN or sample file can match FID + IID present in the covariates and phenotype input files, otherwise the pipeline will fail. Using a <code>.sample</code> file can help to have better control on the sample IDs.</p>
<p>If any of these files is missing, the pipeline will generate them automatically and save them in the output folder by default. This behaviour can be controlled by <code>save_bgen_index</code>, <code>save_bgen_sample</code> parameters. Keep in mind that these steps can add a significant amount of time to the overall execution for large datasets, so it is suggested to prepare these files in advance.</p>
<h3 id="pgen-format">pgen format</h3>
<ul>
<li>input format: <code>'pgen'</code></li>
<li>input dataset: <code>'path/to/my_data'</code></li>
</ul>
<p>For pgen input, you have to specify only the basename of the dataset. Given a input dataset named <code>my_dataset</code>, the pipeline will look for the following files: <code>my_data.pgen</code>, <code>my_data.pvar</code>, <code>my_data.psam</code>.</p>
<h3 id="bed-format">bed format</h3>
<ul>
<li>input format: <code>'bed'</code></li>
<li>input dataset: <code>'path/to/my_data'</code></li>
</ul>
<p>For bed input, you have to specify only the basename of the dataset. Given a input dataset named <code>my_dataset</code>, the pipeline will look for the following files: <code>my_data.bed</code>, <code>my_data.bim</code>, <code>my_data.fam</code>.</p>
<h2 id="input-dataset-split-by-chromosome">Input dataset split by chromosome</h2>
<p>If your input dataset is split by chromosome across multiple files, you can use the <code>{CHROM}</code> tag in your input file name. This tag must be placed corresponding to the number of chromosome in the filename. When using this method be careful that the chromosome names captured from the filename correspond to numbers 1-22 for autosomes.</p>
<p>For example, if you have a dataset split by chromosome in the following way:</p>
<ul>
<li><code>my_dataset_chr1.bgen</code></li>
<li><code>my_dataset_chr2.bgen</code></li>
<li><code>my_dataset_chr3.bgen</code></li>
<li>...</li>
</ul>
<p>You can specify the input dataset as <code>my_dataset_chr{CHROM}.bgen</code> and the pipeline will automatically replace <code>{CHROM}</code> with the chromosome number.</p>
<h2 id="performance-tips">Performance tips</h2>
<p>Note that the pipeline will do highly parallelized access to the input dataset. Thus, especially if you are using a single file as input and when step 2 chunk size is small, it is reccomended to use a high performance filesystem optimized for parallel access.</p>
<p>Regenie step2 will run faster on bgen v1.2 with 8 bits encoding. You can convert existing data using plink2 with <code>--export bgen-1.2 'bits=8'</code> option</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      This pipeline is licensed under the MIT license
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>